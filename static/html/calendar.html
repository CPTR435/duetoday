<!-- calendar.html -->
<script src='static/fullcalendar/lib/moment.min.js'></script>
<script src='static/fullcalendar/fullcalendar.min.js'></script>
<script>
$(document).ready(function() {
  var today = new Date();
var dd = today.getDate();
var mm = today.getMonth()+1; //January is 0!
var yyyy = today.getFullYear();

if(dd<10) {
    dd='0'+dd
}

if(mm<10) {
    mm='0'+mm
}

today = mm+'/'+dd+'/'+yyyy;
	$('#calendar').fullCalendar({
		theme: true,
		header: {
			left: 'prev today next',
			center: 'title',
			right: 'month,agendaWeek,agendaDay'
		},
		defaultDate: today,
		editable: false,
		eventLimit: true, // allow "more" link when too many events
		eventLimitText: 'More',
		events: {
			url: 'events.json',
			error: function() {
				$('#script-warning').show();
			}
		},
		loading: function(bool) {
			$('#loading').toggle(bool);
		},
		// Make sure we don't have multiple scroll bars
		height: 'auto',
		contentHeight: 'auto',
		selectable: true,
		selectHelper: true,
		select: function(start, end) {
			/*var title = prompt('Event Title:');
			var eventData;
			if (title) {
				eventData = {
					title: title,
					start: start,
					end: end
				};
				//$('#calendar').fullCalendar('renderEvent', eventData, true); // stick? = true
			}*/
			start_str=start.format('MM/DD/YYYY')
			end_str=end.subtract(1, 'days').format('MM/DD/YYYY') // through end of previous
			if (start.diff(end, 'days') != 0) // Multiple days
				alert('Selected: '+start_str+' - '+end_str)
			$('#calendar').fullCalendar('unselect');
		},
		dayClick: function(date, allDay, jsEvent, view) {
            $('#calendar').fullCalendar('gotoDate', date);
            $('#calendar').fullCalendar('changeView', 'agendaDay');
		}
	});

	// Full calendar swipe, see comment on
	// http://blog.arshaw.com/1/post/2014/08/fullcalendar-210-released.html
	// swipe initialize
	var recognizers = ["pan", "pinch", "press", "rotate", "tap"];
	var mc = new Hammer(document.getElementById("calendar"));

	for (i=0; i<recognizers.length; i++) {
		mc.get(recognizers[i]).set({enable:false});
	}
	/*mc.get('swipe').set({
		direction: Hammer.DIRECTION_HORIZONTAL,
		threshold: 30,
		velocity: 0.5
	});*/

	mc.on("swipeleft swiperight", function(ev) {
		if(ev.type=="swipeleft")
			$('#calendar').fullCalendar('next');
		else
			$('#calendar').fullCalendar('prev');
	});
});
</script>
<style>
#calendar {
	max-width: 900px;
	margin: 0 auto;
	padding-bottom: 1em;
}
</style>

<br><br>
<div class="row">
  <div class="small-12 columns">
    <!--<h1 style='text-align: center;'>This is the <b>Calendar</b></h1>-->
	<div id="script-warning" style="display: none">Note: could not load data.</div>
	<div id='calendar'></div>
	<div id='loading'>loading...</div>
  </div>
</div>
